<div class="note-form__container" [ngStyle]="containerStyle" *ngIf="shouldShow()">

    <!-- Toggle button for displaying the form. -->
    <button class="note-form__container__toggle govuk-body govuk-!-margin-bottom-0" type="button" name="button" (click)="toggle()">
        Add a note
        <span class="note-form__container__toggle__icon">{{ expanded ? '&minus;' : '&#43;' }}</span>
    </button>

    <div *ngIf="expanded">
        <form class="note-form__container__form govuk-body" #commentForm="ngForm" (ngSubmit)="saveNote()">

            <a class="note-form__container__close" (click)="toggle()">&times;</a>

            <h2 class="govuk-header-m">Add a note</h2>

            <!-- Caller details. -->
            <app-value-list class="govuk-body-s">

                <app-value-list-label *ngIf="!isCallerAnonymous()">Tenancy reference</app-value-list-label>
                <app-value-list-value *ngIf="!isCallerAnonymous()">{{ getTenancyReference() }}</app-value-list-value>

                <app-value-list-label>Tenant</app-value-list-label>
                <app-value-list-value>
                    <span [class.is-anonymous]="isCallerAnonymous()">{{ getCallerName() }}</span>
                </app-value-list-value>

            </app-value-list>

            <!-- Comment field. -->
            <div class="govuk-form-group">
                <label class="govuk-label" for="more-detail">Comments</label>
                <textarea #commentField class="govuk-textarea note-form__field" id="more-detail" name="comment" required tabindex="1"
                    [(ngModel)]="comment" [disabled]="saving" rows="4" aria-describedby="more-detail-hint"></textarea>

                <!-- View notes link. -->
                <a class="govuk-body-s note-form__view-notes" [routerLink]="page_defs.VIEW_NOTES.route">
                    View notes
                </a>
            </div>

            <div class="govuk-form-group govuk-!-margin-bottom-2">

                <!-- Save button. -->
                <button type="submit" class="govuk-button govuk-!-margin-bottom-0 govuk-!-margin-right-1" tabindex="2"
                    [disabled]="!canSaveNote()">
                    Save
                </button>

                <!-- Close button. -->
                <button type="button" class="govuk-button govuk-!-margin-bottom-0" tabindex="4" (click)="toggle()">
                    Cancel
                </button>

            </div>

            <app-error-panel class="govuk-!-margin-bottom-5" *ngIf="error">
                <h2 class="govuk-heading-l govuk-!-margin-bottom-3">Failed to save</h2>
                <p class="govuk-body">
                    There was a problem adding a note to this call. Please try again.
                </p>
                <p class="govuk-body govuk-!-margin-bottom-0">If this continues you will need to contact ICT.</p>
            </app-error-panel>

        </form>
    </div>
</div>
